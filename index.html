<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <title>Desafio - Software para Pizza</title>
    </head>
    <body>

        <form id="idInfosFormulario" action="" method="get">

            <div class="container1">

                <div class="box1">                    

                    <div id="AjusteDaBox1">

                        <div id="Titulo">
                            <h1>Calcular valores das pizzas</h1>
                        </div>

                        <div class="CaixaDigitacao">

                            <label for="idNomePizza">Informe o nome da pizza</label>
                            <input
                                id="idNomePizza"
                                type="text"
                                name="nmNomePizza">
                            
                        </div>
                        
                        <div>

                            <h4></h4>

                        </div>

                        <div class="CaixaRadios">

                            <div class="PizzaRedonda">
                                <label for="idRedonda">Redonda</label>
                                <input
                                    id="idRedonda"
                                    type="radio"
                                    name="nmFormaPizza"
                                    onclick="mudarLabelsECaixas()"
                                    checked>
                            </div>
    
                            <div class="PizzaRetangular">
                                <label for="idRetOuQuad">Quadrada ou Retangular</label>
                                <input
                                    id="idRetOuQuad"
                                    type="radio"
                                    name="nmFormaPizza"
                                    onclick="mudarLabelsECaixas()">
                            </div>
    
                        </div>

                        <div class="CaixaDigitacao">

                            <label for="idPreco">Informe o preço em R$</label>
                            <input
                                id="idPreco"
                                type="number"
                                name="nmPreco">

                        </div>

                        <div class="CaixaDigitacao">

                            <label for="idDiaOuBase" id="idLbDiaOuBase">Informe o diâmetro da pizza (em centímetros)</label>
                            <input
                                id="idDiaOuBase"
                                type="number"
                                name="nmTamanho">
                            
                        </div>

                        <div class="CaixaDigitacaoEscondida">

                            <label for="idAltura" id="idLbAltura">Informe a altura da pizza (em centímetros)</label>
                            <input
                                id="idAltura"
                                type="number"
                                name="nnn">
                            
                        </div>

                        <div class="CaixaDeStatus">

                            <input
                                id="idStatus"
                                name="nmStatus"
                                type="text"
                                readonly>

                        </div>

                    </div>                    

                    <div class="CaixaDeBotoes">

                        <div class="Botao">
                            <input
                                id="idBotaoGuardar"
                                type="button"
                                value="Guardar Informações"
                                onclick="guardarInformacoes()">
                        </div>

                        <div class="Botao">
                            <input
                                id="idMostrarResultado"
                                type="button"
                                value="Mostrar Informações"
                                onclick="mostrarInformacoes()">
                        </div>

                    </div>

                </div>

            </div>

<!---------------------------------------------------------------------------------------- Segunda Página ---------------------------------------------------------------------->

            <div class="container2">

                <div class="box2">

                    <div id="Titulo">
                        <h1>Calcular valores das pizzas</h1>
                    </div>

                    <div id="AjusteDaBox2">

                        <table class="tbClPizzas" id="tbIdPizzas">
                             
                        </table>
                        
                    </div>
                </div>

            </div>


        </form>

        <script>

            //--------------------------------------------------------------- \\ Declaração de variáveis // ---------------------------------------------------------------\\
            
            var pizzas = [];
            var formulario = document.querySelector("#idInfosFormulario")
            var preco = Number(document.getElementById("idPreco").value);
            var precoPCm2, raio, area = 0;

            //------------------------------------------------------------ \\ Função para inicializar o programa // --------------------------------------------------------\\

            iniciar();

            //----------------------------------------------------- \\ Funções para chamar os eventos de click dos botões // -------------------------------------------------\\

            botaoGuardar.onclick = function() {

                let isTelaValida = consistirTela();

                if (isTelaValida) {

                    pesquisarPizza();
                    formulario.reset()
                    organizarTabela()
                    aviso.value = "Cadastro realizado com sucesso"

                }                

            }

            botaoMostrar.onclick = function(){

                adicionaLinha();

            }


            //--------------------------------------------------------------- \\ Funções para cadastrar informações // ------------------------------------------------------\\

            //Extraindo dados do Formulário através do name

            function pesquisarPizza(pizza) {

                var pizza = [];

                    calcularPrecoPCm2(precoPCm2);

                    pizza[0] = formulario.nmNomePizza.value;
                    pizza[1] = formulario.nmTamanho.value;
                    pizza[2] = formulario.nmPreco.value;
                    pizza[3] = Number(precoPCm2.toFixed(2));
                    pizza[4] = 0;

                    pizzas.push(pizza);

            }

            //--------------------------------------------------- \\ Funções de controle de labels e caixas de digitação // -------------------------------------------------\\

            function travarCaixas(){

                document.getElementById("idBotaoGuardar").disabled = true; //Desativa o botão de guardar, quando forem guardados 30 números na array.
                document.getElementById("idNomePizza").disabled = true; //Desativa o botão de guardar, quando forem guardados 30 números na array.
                document.getElementById("idTamanho").disabled = true; //Desativa o botão de guardar, quando forem guardados 30 números na array.
                document.getElementById("idPreco").disabled = true; //Desativa o botão de guardar, quando forem guardados 30 números na array.
                
            }

            //------------------------------------------------------------- \\ Função rotina para inicialização // ---------------------------------------------------------\\

            function iniciar(){

                botaoGuardar = document.getElementById("idBotaoGuardar");
                botaoMostrar = document.getElementById("idMostrarResultado");
                aviso = document.getElementById("idStatus");

            }

            //--------------------------------------------------------- \\ Função para verificar valores inseridos // ---------------------------------------------------------\\

            function consistirTela(){

                let nome = document.getElementById("idNomePizza").value;
                let diaOuBase = document.getElementById("idDiaOuBase").value;
                let altura = document.getElementById("idAltura").value;
                let preco = Number(document.getElementById("idPreco").value);

                if (nome == "" || nome == " ") {

                    aviso.value = "Preenchimento inválido: Campo Nome";
                    aviso.classList.add("alerta");
                    document.getElementById("idNomePizza").focus();                  
                    return false;

                }

                if (diaOuBase == "" || diaOuBase == " ") {

                    aviso.value = "Preenchimento inválido: Campo diâmetro ou base";
                    aviso.classList.add("alerta");
                    document.getElementById("idDiaOuBase").focus();
                    return false;

                }

                //if (altura == "" || altura == " ") {

                   // aviso.value = "Preenchimento inválido: Campo altura";
                   // aviso.classList.add("alerta");
                   // document.getElementById("idAltura").focus();
                   // return false;

                //}

                if (preco == "" || preco == " ") {

                    aviso.value = "Preenchimento inválido: Campo preco";
                    aviso.classList.add("alerta");
                    document.getElementById("idPreco").focus();
                    return false;

                }

                aviso.classList.remove("alerta");
                return true;

            }

            //---------------------------------------------------------- \\ Função para calcular preço por tamanho //-----------------=----------------------------------------\\

            function calcularPrecoPCm2(){

                let redonda = document.getElementById("idRedonda").checked;
                let quadOuRet = document.getElementById("idRetOuQuad").checked;
                let diaOuBase = Number(document.getElementById("idDiaOuBase").value);
                let altura = Number(document.getElementById("idAltura").value);
                let preco = Number(document.getElementById("idPreco").value);
                let area = 0;
                let raio = 0;

                if (redonda){

                    raio = diaOuBase / 2;

                    area = Math.PI * (raio ** 2);

                    precoPCm2 = preco / area;

                } else {

                    area = diaOuBase * altura;

                    precoPCm2 = preco / area;

                }

            }
            //---------------------------------------------------------- \\ Função para calcular preço por tamanho //-----------------=----------------------------------------\\

            function mudarLabelsECaixas(){

                let redonda = document.getElementById("idRedonda").checked;
                let quadOuRet = document.getElementById("idRetOuQuad").checked;                
                let caixaVisivel = document.querySelector(".CaixaDigitacaoEscondida");
                
                if (redonda){

                    caixaVisivel.style.visibility = "hidden";
                    document.querySelector("#idLbDiaOuBase").innerText = "Informe o diâmetro da pizza (em centímetros)";

                } else {

                    caixaVisivel.style.visibility = "visible";
                    document.querySelector("#idLbDiaOuBase").innerText = "Informe o tamanho da base da pizza (em centímetros)";


                }

            }


            //---------------------------------------------------- \\ Funções para adicionar linhas e colunas // --------------------------------------------------------------\\

            function organizarTabela(){

                pizzas.sort(function(a, b){

                    if (a[3] > b[3]) {
                        return 1
                    }

                    if (a[3] < b[3]) {
                        return -1
                    }

                    return 0
                        
                })

            }

            //---------------------------------------------------- \\ Funções para adicionar linhas e colunas // --------------------------------------------------------------\\



            //---------------------------------------------------- \\ Funções para adicionar linhas e colunas // --------------------------------------------------------------\\

            function adicionaLinha(){
                
                let tabela = document.getElementById("tbIdPizzas");

                let thead = document.createElement("thead");
                let tbody = document.createElement("tbody");

                let cabecalho = ["Nome", "Tamanho", "Preço", "Preço p/cm²", "Diferença%"]
                let linhaCabecalho = document.createElement("tr");

                for (let i = 0; i < cabecalho.length; i++) {
                    let th = document.createElement("th");
                    th.textContent = cabecalho[i];
                    linhaCabecalho.appendChild(th);
                }

                thead.appendChild(linhaCabecalho)
                tabela.appendChild(thead);
                tabela.appendChild(tbody);

                for (let i = 0; i < pizzas.length; i++) {

                    let linhaCorpo = document.createElement("tr");

                    for (let j = 0; j < pizzas[i].length; j++) {

                        let celula = document.createElement("td");
                        celula.textContent = pizzas[i][j]
                        linhaCorpo.appendChild(celula)
                        
                    }
                    
                    tbody.appendChild(linhaCorpo);
                }

            }

        </script>
    </body>
</html>